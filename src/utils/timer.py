'''
üîπ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏:

–∏–∑–º–µ—Ä—è—Ç—å –æ–±—â–µ–µ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è;

–∏–∑–º–µ—Ä—è—Ç—å –≤—Ä–µ–º—è –Ω–∞ evaluation (–ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é).

üîπ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:
import time

class Timer:
    def __enter__(self):
        self.start = time.time()
        return self

    def __exit__(self, *args):
        self.end = time.time()
        self.interval = self.end - self.start
        print(f"[TIMER] Elapsed time: {self.interval:.2f} seconds")

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
# with Timer():
#     train(model, dataloader)


üí° –í—Å—ë. –ë–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –±–µ–∑ —É—Å–ª–æ–∂–Ω–µ–Ω–∏–π.
–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É –≤—ã–∑–æ–≤–æ–≤ with Timer(): –≤ train.py –∏ evaluate.py, —ç—Ç–æ–≥–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è production-–æ—â—É—â–µ–Ω–∏—è.
''' 


# –¶–µ–ª—å: –ó–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ —ç—Ç–∞–ø–æ–≤ –ø–∞–π–ø–ª–∞–π–Ω–∞ (train/val/inference).

# –°–æ–¥–µ—Ä–∂–∏–º–æ–µ: –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä with timer("train"), –ø—Ä–æ—Å—Ç–æ–π print –∏–ª–∏ –∑–∞–ø–∏—Å—å –≤ –ª–æ–≥.

##

# –ß—Ç–æ –±—É–¥–µ—Ç –≤–Ω—É—Ç—Ä–∏:

# –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä with timer("train"):

# –ü—Ä–æ—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—á–∞—Ç–∏ –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ logger.